<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¥ç¶šãƒ†ã‚¹ãƒˆ - AIã‚»ãƒ«ãƒ•ãƒˆãƒ¼ã‚¯ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #e0f2fe 0%, #f3e5f5 100%);
            min-height: 100vh;
        }
        .status-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 10px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .success { border-left: 5px solid #4caf50; }
        .error { border-left: 5px solid #f44336; }
        .warning { border-left: 5px solid #ff9800; }
        .info { border-left: 5px solid #2196f3; }
        .test-result {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 5px;
            font-weight: bold;
            margin-left: 10px;
        }
        .pass { background: #4caf50; color: white; }
        .fail { background: #f44336; color: white; }
        button {
            background: #2196f3;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #1976d2; }
        pre {
            background: #f5f5f5;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <h1>ğŸš€ AIã‚»ãƒ«ãƒ•ãƒˆãƒ¼ã‚¯ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚° - ã‚·ã‚¹ãƒ†ãƒ è¨ºæ–­</h1>
    
    <div class="status-card info">
        <h2>ğŸ” ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±</h2>
        <p><strong>ç¾åœ¨æ™‚åˆ»:</strong> <span id="current-time"></span></p>
        <p><strong>ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ:</strong> <span id="user-agent"></span></p>
        <p><strong>ç”»é¢ã‚µã‚¤ã‚º:</strong> <span id="screen-size"></span></p>
        <p><strong>è¨€èª:</strong> <span id="language"></span></p>
    </div>

    <div class="status-card" id="local-storage-test">
        <h2>ğŸ’¾ ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ†ã‚¹ãƒˆ</h2>
        <p>ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãŒåˆ©ç”¨å¯èƒ½ã‹ãƒ†ã‚¹ãƒˆã—ã¾ã™...</p>
        <button onclick="testLocalStorage()">ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
        <div id="localStorage-result"></div>
    </div>

    <div class="status-card" id="api-key-test">
        <h2>ğŸ”‘ APIã‚­ãƒ¼ãƒ†ã‚¹ãƒˆ</h2>
        <p>ç’°å¢ƒå¤‰æ•°ã‹ã‚‰APIã‚­ãƒ¼ãŒèª­ã¿è¾¼ã‚ã‚‹ã‹ãƒ†ã‚¹ãƒˆã—ã¾ã™...</p>
        <button onclick="testApiKey()">ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
        <div id="apiKey-result"></div>
    </div>

    <div class="status-card" id="network-test">
        <h2>ğŸŒ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆ</h2>
        <p>å¤–éƒ¨APIã¸ã®æ¥ç¶šã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™...</p>
        <button onclick="testNetwork()">ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
        <div id="network-result"></div>
    </div>

    <div class="status-card">
        <h2>ğŸ”§ ãƒ‡ãƒãƒƒã‚°æƒ…å ±</h2>
        <button onclick="showDebugInfo()">ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã‚’è¡¨ç¤º</button>
        <button onclick="clearAllData()">å…¨ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªã‚¢</button>
        <button onclick="window.location.href='/'">ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã«ç§»å‹•</button>
        <pre id="debug-info" style="display: none;"></pre>
    </div>

    <script>
        // ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±ã®è¡¨ç¤º
        function updateSystemInfo() {
            document.getElementById('current-time').textContent = new Date().toLocaleString('ja-JP');
            document.getElementById('user-agent').textContent = navigator.userAgent;
            document.getElementById('screen-size').textContent = `${window.innerWidth} x ${window.innerHeight}`;
            document.getElementById('language').textContent = navigator.language;
        }

        // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ†ã‚¹ãƒˆ
        function testLocalStorage() {
            const resultDiv = document.getElementById('localStorage-result');
            try {
                localStorage.setItem('test', 'value');
                const value = localStorage.getItem('test');
                localStorage.removeItem('test');
                
                if (value === 'value') {
                    resultDiv.innerHTML = '<span class="test-result pass">PASS</span> ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã¯æ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã¾ã™';
                    document.getElementById('local-storage-test').className = 'status-card success';
                } else {
                    throw new Error('å€¤ã®èª­ã¿æ›¸ãã«å¤±æ•—');
                }
            } catch (error) {
                resultDiv.innerHTML = '<span class="test-result fail">FAIL</span> ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚¨ãƒ©ãƒ¼: ' + error.message;
                document.getElementById('local-storage-test').className = 'status-card error';
            }
        }

        // APIã‚­ãƒ¼ãƒ†ã‚¹ãƒˆ
        function testApiKey() {
            const resultDiv = document.getElementById('apiKey-result');
            
            // ã“ã®ç°¡æ˜“ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã§ã¯ç’°å¢ƒå¤‰æ•°ã‚’ç›´æ¥èª­ã¿å–ã‚Œãªã„ãŸã‚ã€
            // ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã®åˆæœŸåŒ–çŠ¶æ³ã‚’ç¢ºèª
            try {
                const hasApiKey = localStorage.getItem('api_key_configured') || 'unknown';
                resultDiv.innerHTML = `<span class="test-result ${hasApiKey === 'true' ? 'pass' : 'fail'}">${hasApiKey === 'true' ? 'PASS' : 'CHECK'}</span> APIã‚­ãƒ¼çŠ¶æ…‹: ${hasApiKey}`;
                document.getElementById('api-key-test').className = hasApiKey === 'true' ? 'status-card success' : 'status-card warning';
            } catch (error) {
                resultDiv.innerHTML = '<span class="test-result fail">FAIL</span> APIã‚­ãƒ¼ãƒã‚§ãƒƒã‚¯ã‚¨ãƒ©ãƒ¼: ' + error.message;
                document.getElementById('api-key-test').className = 'status-card error';
            }
        }

        // ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆ
        async function testNetwork() {
            const resultDiv = document.getElementById('network-result');
            resultDiv.innerHTML = 'ğŸ”„ ãƒ†ã‚¹ãƒˆä¸­...';
            
            try {
                // ç°¡å˜ãªæ¥ç¶šãƒ†ã‚¹ãƒˆ
                const response = await fetch('https://httpbin.org/get', { 
                    method: 'GET',
                    mode: 'cors'
                });
                
                if (response.ok) {
                    resultDiv.innerHTML = '<span class="test-result pass">PASS</span> ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã¯æ­£å¸¸ã§ã™';
                    document.getElementById('network-test').className = 'status-card success';
                } else {
                    throw new Error(`HTTP ${response.status}`);
                }
            } catch (error) {
                resultDiv.innerHTML = '<span class="test-result fail">FAIL</span> ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼: ' + error.message;
                document.getElementById('network-test').className = 'status-card error';
            }
        }

        // ãƒ‡ãƒãƒƒã‚°æƒ…å ±è¡¨ç¤º
        function showDebugInfo() {
            const debugDiv = document.getElementById('debug-info');
            const info = {
                timestamp: new Date().toISOString(),
                location: window.location.href,
                localStorage: Object.keys(localStorage),
                sessionStorage: Object.keys(sessionStorage),
                cookies: document.cookie,
                referrer: document.referrer,
                onlineStatus: navigator.onLine,
                connectionType: navigator.connection?.effectiveType || 'unknown',
                memory: performance.memory ? {
                    used: Math.round(performance.memory.usedJSHeapSize / 1024 / 1024) + 'MB',
                    total: Math.round(performance.memory.totalJSHeapSize / 1024 / 1024) + 'MB'
                } : 'unknown'
            };
            
            debugDiv.textContent = JSON.stringify(info, null, 2);
            debugDiv.style.display = 'block';
        }

        // å…¨ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªã‚¢
        function clearAllData() {
            if (confirm('å…¨ã¦ã®ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿã“ã®æ“ä½œã¯å…ƒã«æˆ»ã›ã¾ã›ã‚“ã€‚')) {
                localStorage.clear();
                sessionStorage.clear();
                alert('ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã—ãŸ');
                location.reload();
            }
        }

        // åˆæœŸåŒ–
        updateSystemInfo();
        setInterval(updateSystemInfo, 1000);

        // è‡ªå‹•ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
        setTimeout(() => {
            testLocalStorage();
            testApiKey();
        }, 500);
    </script>
</body>
</html>